<<<<<<< HEAD
h=conf_matrix$overall[1]
for (i in 1:3){
for(j in 1:length(c)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1
if(cl[j] == mod(i,3)+1{cl[j]=mod(i-1,3)+1})
}
}
print(cl)
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{a=cl}
}
return(cl)
}
correct=function(cl){
a=cl
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
h=conf_matrix$overall[1]
for (i in 1:3){
for(j in 1:length(c)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1}
if(cl[j] == mod(i,3)+1){cl[j]=mod(i-1,3)+1}
}
print(cl)
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{a=cl}
}
return(cl)
}
classes_kmeans = fitted(kmeans_clust, method="classes")
#KMeans
kmeans_clust = kmeans(X, 3, iter.max=50, nstart=10)
classes_kmeans = fitted(kmeans_clust, method="classes")
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
correct=function(cl){
a=cl
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
h=conf_matrix$overall[1]
for (i in 1:3){
for(j in 1:length(cl)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1}
if(cl[j] == mod(i,3)+1){cl[j]=mod(i-1,3)+1}
}
print(cl)
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{a=cl}
}
return(cl)
}
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
classes_kmeans = fitted(kmeans_clust, method="classes")
classes_kmeans
correct=function(cl){
a=cl
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
h=conf_matrix$overall[1]
for (i in 1:5){
for(j in 1:length(cl)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1}
if(cl[j] == mod(i,3)+1){cl[j]=mod(i-1,3)+1}
}
print(cl)
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{a=cl}
}
return(a)
}
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
length(cl)
length(classes_kmeans)
classes_kmeans[63]== mod(i-1,3)+1
classes_kmeans[64]== mod(i-1,3)+1
classes_kmeans[65]== mod(i-1,3)+1
classes_kmeans = fitted(kmeans_clust, method="classes")
#KMeans
kmeans_clust = kmeans(X, 3, iter.max=50, nstart=10)
classes_kmeans = fitted(kmeans_clust, method="classes")
classes_kmeans
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
correct=function(cl){
a=cl
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
h=conf_matrix$overall[1]
for (i in 1:5){
for(j in 1:length(cl)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1}
else if(cl[j] == mod(i,3)+1){
cl[j]=mod(i-1,3)+1}
}
print(cl)
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{a=cl}
}
return(a)
}
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
confusionMatrix(table(true=seeds$type,pred=classes_kmeans))
correct=function(cl){
a=cl
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
h=conf_matrix$overall[1]
for (i in 1:5){
for(j in 1:length(cl)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1}
else if(cl[j] == mod(i,3)+1){
cl[j]=mod(i-1,3)+1}
}
print(cl)
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{ h= conf_matrix$overall[1]
a=cl}
}
return(a)
}
kmeans_clust = kmeans(X, 3, iter.max=50, nstart=10)
classes_kmeans = fitted(kmeans_clust, method="classes")
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
#Accuracy - kmeans clustering
acc_kmeans = tr(conf_matrix_kmeans)/210
print(paste("KMeans Clustering accuracy = ", toString(acc_kmeans)))
kmeans_clust = kmeans(X, 3, iter.max=50, nstart=10)
classes_kmeans = fitted(kmeans_clust, method="classes")
#Confusion matrix - kmeans clustering
classes_kmeans=correct(classes_kmeans)
conf_matrix_kmeans = table(true=seeds$type,pred=classes_kmeans)
conf_matrix_kmeans
correct=function(cl){
a=cl
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
h=conf_matrix$overall[1]
for (i in 1:6){
for(j in 1:length(cl)){
if(cl[j]== mod(i-1,3)+1){
cl[j]=mod(i,3)+1}
else if(cl[j] == mod(i,3)+1){
cl[j]=mod(i-1,3)+1}
}
conf_matrix =confusionMatrix(table(true=seeds$type,pred=cl))
print(conf_matrix$overall[1])
if (conf_matrix$overall[1]>h)
{ h= conf_matrix$overall[1]
a=cl}
}
return(a)
}
=======
confusionMatrix(mtab)
smp_size <- floor(0.75 * nrow(df))
train_ind <- sample(seq_len(nrow(df)), size = smp_size)
train <- df[train_ind, ]
test <- df[-train_ind, ]
#LDA
#Build the model
model2<-qda(x=train[,-c(8)],grouping = train[,8],data=train,CV= FALSE)
#Summarize the model
summary(model2)
#Predict using the model
test1=test
predseeds= predict(model2,test[,-c(8)])
test1$pred_lda<-predict(model2,test[,-c(8)])$class
#Accuracy of the model
mtab<-table(test1$pred_lda,test[,8])
confusionMatrix(mtab)
smp_size <- floor(0.75 * nrow(df))
train_ind <- sample(seq_len(nrow(df)), size = smp_size)
train <- df[train_ind, ]
test <- df[-train_ind, ]
#LDA
#Build the model
model2<-qda(x=train[,-c(8)],grouping = train[,8],data=train,CV= FALSE)
#Summarize the model
summary(model2)
#Predict using the model
test1=test
predseeds= predict(model2,test[,-c(8)])
test1$pred_lda<-predict(model2,test[,-c(8)])$class
#Accuracy of the model
mtab<-table(test1$pred_lda,test[,8])
confusionMatrix(mtab)
smp_size <- floor(0.75 * nrow(df))
train_ind <- sample(seq_len(nrow(df)), size = smp_size)
train <- df[train_ind, ]
test <- df[-train_ind, ]
#LDA
#Build the model
model2<-qda(x=train[,-c(8)],grouping = train[,8],data=train,CV= FALSE)
#Summarize the model
summary(model2)
#Predict using the model
test1=test
predseeds= predict(model2,test[,-c(8)])
test1$pred_lda<-predict(model2,test[,-c(8)])$class
#Accuracy of the model
mtab<-table(test1$pred_lda,test[,8])
confusionMatrix(mtab)
smp_size <- floor(0.75 * nrow(df))
train_ind <- sample(seq_len(nrow(df)), size = smp_size)
train <- df[train_ind, ]
test <- df[-train_ind, ]
#LDA
#Build the model
model2<-qda(x=train[,-c(8)],grouping = train[,8],data=train,CV= FALSE)
#Summarize the model
summary(model2)
#Predict using the model
test1=test
predseeds= predict(model2,test[,-c(8)])
test1$pred_lda<-predict(model2,test[,-c(8)])$class
#Accuracy of the model
mtab<-table(test1$pred_lda,test[,8])
confusionMatrix(mtab)
smp_size <- floor(0.75 * nrow(df))
train_ind <- sample(seq_len(nrow(df)), size = smp_size)
train <- df[train_ind, ]
test <- df[-train_ind, ]
#LDA
#Build the model
model2<-qda(x=train[,-c(8)],grouping = train[,8],data=train,CV= FALSE)
#Summarize the model
summary(model2)
#Predict using the model
test1=test
predseeds= predict(model2,test[,-c(8)])
test1$pred_lda<-predict(model2,test[,-c(8)])$class
#Accuracy of the model
mtab<-table(test1$pred_lda,test[,8])
confusionMatrix(mtab)
smp_size <- floor(0.75 * nrow(df))
train_ind <- sample(seq_len(nrow(df)), size = smp_size)
train <- df[train_ind, ]
test <- df[-train_ind, ]
#LDA
#Build the model
model2<-qda(x=train[,-c(8)],grouping = train[,8],data=train,CV= FALSE)
#Summarize the model
summary(model2)
#Predict using the model
test1=test
predseeds= predict(model2,test[,-c(8)])
test1$pred_lda<-predict(model2,test[,-c(8)])$class
#Accuracy of the model
mtab<-table(test1$pred_lda,test[,8])
confusionMatrix(mtab)
predseeds
View(predseeds)
seeds
cor(seeds$C,seeds$asymmetry)
cor(seeds$compactness,seeds$asymmetry)
range(seeds$asymmetry)
##Preliminary Analysis (Frank) --- Standardization, Plots...
#summary of the data
summary(seeds)
>>>>>>> 794e3a83386aff673c6eeab73b6fa81e2214bf0a
library(tidyverse)
library(dplyr)
library(rpart)
library(naniar)
library(FactoMineR)
library(fitdistrplus)
library(Hmisc)
library(MASS)
library(rcompanion)
library(lsr)
require(corrr)
library(stats)
library(e1071)
library(GGally)
ggpairs(seeds, aes(colour = Species, alpha = 0.4))
library(caret)
library(missMDA)
library(fastDummies)
library(mice)
library(reshape2)
library(ggplot2)
library(devtools)
#library(ggbiplot)
library(fBasics)
library(corrplot)
library(numbers)
summary(seeds)
ggpairs(seeds, aes(colour = type, alpha = 0.4))
pairs(seeds,col=seeds[,8])
ggpairs(seeds, aes(colour = type, alpha = 0.4))
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5,position = "fill")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5,position = "fill")
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5)
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5,adjust= 1/5)
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5,position = "fill")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly(alpha=0.5)
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
ggplot(data=seeds,mapping = aes(x=type)) +
geom_bar()        # we have the same amount of each type of plant
pairs(seeds,col=seeds[,8])
ggpairs(seeds, aes(colour = type, alpha = 0.4))
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5,position = "fill")
ggplot(data=seeds,mapping = aes(x=type)) +
geom_bar()        # we have the same amount of each type of plant
ggplot(diamonds, aes(depth, fill = cut, colour = cut)) +
facet_wrap(~variable,scales = "free")
geom_density(alpha = 0.1) +
xlim(55, 70)
geom_density(alpha = 0.1)
ggplot(diamonds, aes(depth, fill = cut, colour = cut)) +
facet_wrap(~variable,scales = "free") +
geom_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type) +
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free") +
geom_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free") +
geom_density(alpha = 0.1)
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_y") +
geom_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable) +
geom_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1,stat = bin)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1,stat = "bin")
1
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1,stat = "bin")
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
stat_density(alpha = 0.1,stat = ,sm)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
stat_density(alpha = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
stat_density(alpha = 0.1,stat = "bin")
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1,stat = "bin")
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1,stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_freqpoly()
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.1,stat = "bin")
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin")
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin",binwidth = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin",binwidth = 0.001)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin",binwidth = 0.01)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin",binwidth = 0.1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin",binwidth = 1)
ggplot(d, aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x",shrink = TRUE) +
geom_density(alpha = 0.3,stat = "bin")
ggplot(d,aes(x = value,fill= type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_area(stat = "bin")
#conditional density estimate
ggplot(d,aes(x = value, fill = type,colour = type)) +
facet_wrap(~variable,scales = "free_x") +
geom_density(alpha = 0.5,position = "fill")
ggplot(data=seeds,mapping = aes(x=type)) +
geom_bar()        # we have the same amount of each type of plant
pairs(seeds,col=seeds[,8])
ggpairs(seeds, aes(colour = type, alpha = 0.4))
#correlation
df_res = mixed_assoc(seeds)
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
# geom_text(aes(x,y,label=assoc))+
scale_fill_gradient(low="red", high="yellow")+
theme_classic()
corMatrix
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient(low="red", high="yellow")+
theme_classic()
corMatrix
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient2(low="red",mid = "white" high="yellow")+
theme_classic()
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient2(low="red",mid = "white", high="yellow")+
theme_classic()
corMatrix
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient2(low="red",mid = "white", high="yellow")
# theme_classic()
corMatrix
View(df)
#correlation
df_res = mixed_assoc(seeds)
View(df_res)
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
seeds %>%
mixed_assoc() %>%
dplyr::select(x, y, assoc) %>%
spread(y, assoc) %>%
column_to_rownames("x") %>%
as.matrix %>%
as_cordf %>%
network_plot()
<<<<<<< HEAD
#correlation
df_res = mixed_assoc(seeds)
#secondary function
mixed_assoc = function(df, cor_method="spearman", adjust_cramersv_bias=TRUE){
df_comb = expand.grid(names(df), names(df),  stringsAsFactors = F) %>% set_names("X1", "X2")
is_nominal = function(x) class(x) %in% c("factor", "character")
# https://community.rstudio.com/t/why-is-purr-is-numeric-deprecated/3559
# https://github.com/r-lib/rlang/issues/781
is_numeric <- function(x) { is.integer(x) || is_double(x)}
f = function(xName,yName) {
x =  pull(df, xName)
y =  pull(df, yName)
result = if(is_nominal(x) && is_nominal(y)){
# use bias corrected cramersV as described in https://rdrr.io/cran/rcompanion/man/cramerV.html
cv = cramerV(as.character(x), as.character(y), bias.correct = adjust_cramersv_bias)
data.frame(xName, yName, assoc=cv, type="cramersV")
}else if(is_numeric(x) && is_numeric(y)){
correlation = cor(x, y, method=cor_method, use="complete.obs")
data.frame(xName, yName, assoc=correlation, type="correlation")
}else if(is_numeric(x) && is_nominal(y)){
# from https://stats.stackexchange.com/questions/119835/correlation-between-a-nominal-iv-and-a-continuous-dv-variable/124618#124618
r_squared = summary(lm(x ~ y))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else if(is_nominal(x) && is_numeric(y)){
r_squared = summary(lm(y ~x))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else {
warning(paste("unmatched column type combination: ", class(x), class(y)))
}
# finally add complete obs number and ratio to table
result %>% mutate(complete_obs_pairs=sum(!is.na(x) & !is.na(y)), complete_obs_ratio=complete_obs_pairs/length(x)) %>% rename(x=xName, y=yName)
}
# apply function to each variable combination
map2_df(df_comb$X1, df_comb$X2, f)
}
#correlation
df_res = mixed_assoc(seeds)
#secondary function
mixed_assoc = function(df, cor_method="spearman", adjust_cramersv_bias=TRUE){
df_comb = expand.grid(names(df), names(df),  stringsAsFactors = F) %>% set_names("X1", "X2")
is_nominal = function(x) class(x) %in% c("factor", "character")
# https://community.rstudio.com/t/why-is-purr-is-numeric-deprecated/3559
# https://github.com/r-lib/rlang/issues/781
is_numeric <- function(x) { is.integer(x) || is_double(x)}
f = function(xName,yName) {
x =  pull(df, xName)
y =  pull(df, yName)
result = if(is_nominal(x) && is_nominal(y)){
# use bias corrected cramersV as described in https://rdrr.io/cran/rcompanion/man/cramerV.html
cv = cramerV(as.character(x), as.character(y), bias.correct = adjust_cramersv_bias)
data.frame(xName, yName, assoc=cv, type="cramersV")
}else if(is_numeric(x) && is_numeric(y)){
correlation = cor(x, y, method=cor_method, use="complete.obs")
data.frame(xName, yName, assoc=correlation, type="correlation")
}else if(is_numeric(x) && is_nominal(y)){
# from https://stats.stackexchange.com/questions/119835/correlation-between-a-nominal-iv-and-a-continuous-dv-variable/124618#124618
r_squared = summary(lm(x ~ y))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else if(is_nominal(x) && is_numeric(y)){
r_squared = summary(lm(y ~x))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else {
warning(paste("unmatched column type combination: ", class(x), class(y)))
}
# finally add complete obs number and ratio to table
result %>% mutate(complete_obs_pairs=sum(!is.na(x) & !is.na(y)), complete_obs_ratio=complete_obs_pairs/length(x)) %>% rename_(x=xName, y=yName)
}
# apply function to each variable combination
map2_df(df_comb$X1, df_comb$X2, f)
}
#correlation
df_res = mixed_assoc(seeds)
# finally add complete obs number and ratio to table
result %>% mutate(complete_obs_pairs=sum(!is.na(x) & !is.na(y)), complete_obs_ratio=complete_obs_pairs/length(x)) %>% rename(x=xName, y=yName)
#secondary function
mixed_assoc = function(df, cor_method="spearman", adjust_cramersv_bias=TRUE){
df_comb = expand.grid(names(df), names(df),  stringsAsFactors = F) %>% set_names("X1", "X2")
is_nominal = function(x) class(x) %in% c("factor", "character")
# https://community.rstudio.com/t/why-is-purr-is-numeric-deprecated/3559
# https://github.com/r-lib/rlang/issues/781
is_numeric <- function(x) { is.integer(x) || is_double(x)}
f = function(xName,yName) {
x =  pull(df, xName)
y =  pull(df, yName)
result = if(is_nominal(x) && is_nominal(y)){
# use bias corrected cramersV as described in https://rdrr.io/cran/rcompanion/man/cramerV.html
cv = cramerV(as.character(x), as.character(y), bias.correct = adjust_cramersv_bias)
data.frame(xName, yName, assoc=cv, type="cramersV")
}else if(is_numeric(x) && is_numeric(y)){
correlation = cor(x, y, method=cor_method, use="complete.obs")
data.frame(xName, yName, assoc=correlation, type="correlation")
}else if(is_numeric(x) && is_nominal(y)){
# from https://stats.stackexchange.com/questions/119835/correlation-between-a-nominal-iv-and-a-continuous-dv-variable/124618#124618
r_squared = summary(lm(x ~ y))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else if(is_nominal(x) && is_numeric(y)){
r_squared = summary(lm(y ~x))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else {
warning(paste("unmatched column type combination: ", class(x), class(y)))
}
# finally add complete obs number and ratio to table
result %>% mutate(complete_obs_pairs=sum(!is.na(x) & !is.na(y)), complete_obs_ratio=complete_obs_pairs/length(x)) %>% rename(x=xName, y=yName)
}
# apply function to each variable combination
map2_df(df_comb$X1, df_comb$X2, f)
}
#correlation
df_res = mixed_assoc(seeds)
library(plyr)
#secondary function
mixed_assoc = function(df, cor_method="spearman", adjust_cramersv_bias=TRUE){
df_comb = expand.grid(names(df), names(df),  stringsAsFactors = F) %>% set_names("X1", "X2")
is_nominal = function(x) class(x) %in% c("factor", "character")
# https://community.rstudio.com/t/why-is-purr-is-numeric-deprecated/3559
# https://github.com/r-lib/rlang/issues/781
is_numeric <- function(x) { is.integer(x) || is_double(x)}
f = function(xName,yName) {
x =  pull(df, xName)
y =  pull(df, yName)
result = if(is_nominal(x) && is_nominal(y)){
# use bias corrected cramersV as described in https://rdrr.io/cran/rcompanion/man/cramerV.html
cv = cramerV(as.character(x), as.character(y), bias.correct = adjust_cramersv_bias)
data.frame(xName, yName, assoc=cv, type="cramersV")
}else if(is_numeric(x) && is_numeric(y)){
correlation = cor(x, y, method=cor_method, use="complete.obs")
data.frame(xName, yName, assoc=correlation, type="correlation")
}else if(is_numeric(x) && is_nominal(y)){
# from https://stats.stackexchange.com/questions/119835/correlation-between-a-nominal-iv-and-a-continuous-dv-variable/124618#124618
r_squared = summary(lm(x ~ y))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else if(is_nominal(x) && is_numeric(y)){
r_squared = summary(lm(y ~x))$r.squared
data.frame(xName, yName, assoc=sqrt(r_squared), type="anova")
}else {
warning(paste("unmatched column type combination: ", class(x), class(y)))
}
# finally add complete obs number and ratio to table
result %>% mutate(complete_obs_pairs=sum(!is.na(x) & !is.na(y)), complete_obs_ratio=complete_obs_pairs/length(x)) %>% rename(x=xName, y=yName)
}
# apply function to each variable combination
map2_df(df_comb$X1, df_comb$X2, f)
}
#correlation
df_res = mixed_assoc(seeds)
install.packages("corrplot")
library(tidyverse)
library(dplyr)
library(rpart)
library(naniar)
library(FactoMineR)
library(fitdistrplus)
library(Hmisc)
library(MASS)
library(rcompanion)
library(lsr)
require(corrr)
library(stats)
library(e1071)
library(GGally)
ggpairs(seeds, aes(colour = Species, alpha = 0.4))
library(caret)
library(missMDA)
library(fastDummies)
library(mice)
library(reshape2)
library(ggplot2)
library(devtools)
library(ggbiplot)
library(fBasics)
library(corrplot)
library(tidyverse)
library(dplyr)
library(rpart)
library(naniar)
library(FactoMineR)
library(fitdistrplus)
library(Hmisc)
library(MASS)
library(rcompanion)
library(lsr)
require(corrr)
library(stats)
library(e1071)
library(GGally)
ggpairs(seeds, aes(colour = Species, alpha = 0.4))
library(caret)
library(missMDA)
library(fastDummies)
library(mice)
library(reshape2)
library(ggplot2)
library(devtools)
#correlation
df_res = mixed_assoc(seeds)
library(tidyverse)
library(dplyr)
library(rpart)
library(naniar)
library(FactoMineR)
library(fitdistrplus)
library(Hmisc)
library(MASS)
library(rcompanion)
library(lsr)
require(corrr)
library(stats)
library(e1071)
library(GGally)
ggpairs(seeds, aes(colour = Species, alpha = 0.4))
library(caret)
library(missMDA)
library(fastDummies)
library(mice)
library(reshape2)
library(ggplot2)
library(devtools)
library(ggbiplot)
library(fBasics)
library(corrplot)
library(numbers)
install.packages(c("mice","GGally","fastDummies","missMDA", "caret", "corrr", "dplyr", "e1071", "FactoMineR", "fitdistrplus", "Hmisc", "lsr", "naniar", "rcompanion", "tidyverse", "devtools", "fBasics"))
install.packages(c("mice", "GGally", "fastDummies", "missMDA", "caret", "corrr", "dplyr", "e1071", "FactoMineR", "fitdistrplus", "Hmisc", "lsr", "naniar", "rcompanion", "tidyverse", "devtools", "fBasics"))
install.packages(c("mice", "GGally", "fastDummies", "missMDA", "caret", "corrr", "dplyr", "e1071", "FactoMineR", "fitdistrplus", "Hmisc", "lsr", "naniar", "rcompanion", "tidyverse", "devtools", "fBasics"))
install.packages(c("mice","GGally","fastDummies","missMDA", "caret", "corrr", "dplyr", "e1071", "FactoMineR", "fitdistrplus", "Hmisc", "lsr", "naniar", "rcompanion", "tidyverse", "devtools", "fBasics"))
=======
# theme_classic()
corMatrix
ggcorrplot(df_res)
install.packages("ggcorrplot")
#install.packages("ggcorrplot")
library(ggcorrplot)
ggcorrplot(df_res)
df_res
View(df_res)
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient2(low="red",mid = "white", high="yellow",)
# theme_classic()
corMatrix
View(df_res)
df_res %>%
ggcorrplot(aes(x,y,fill=assoc))
df_res %>%
ggcorrplot(aes(x,y,fill=assoc))
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()
geom_text(aes(x,y,label=round(assoc,digits = 2)))
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))
# theme_classic()
corMatrix
# theme_classic()
corMatrix
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()
# theme_classic()
corMatrix
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient2(low="red",mid = "white", high="yellow",)
View(df_res)
p.mat <- cor_pmat(seeds)
seeds
p.mat <- cor(seeds)
ggcorrplot(cor(seeds[1:7]))
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
ggcorrplot(cor(seeds[1:7]),method = "circle")
ggcorrplot(cor(seeds[1:7]),method = "square")
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white")
# theme_classic()
corMatrix
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient(low="red", high="yellow",)
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient(low="red", high="yellow",)
# theme_classic()
corMatrix
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE)
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank")
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
# theme_classic()
corMatrix
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper")
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("blue", "white", "blue"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("red", "white", "red"))
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("red", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("yellow", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = ggplot2::theme_gray,colors = c("yellow", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = ggplot2::theme_gray,colors = c("#6D9EC1", "white", "#E46726"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = ggplot2::theme_gray,colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = theme_bw(),colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = theme_void(),colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = theme_classic(),colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = theme_minimal(),colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",ggtheme = theme_grey(),colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("blue", "white", "red"))
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45)
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,lab=TRUE)
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,method = "square")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,method = "square")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,method = "square")
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,method = "circle")
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("blue", "white", "red"))
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,method = "circle")
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",type = "upper",colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",colors = c("blue", "white", "red"))
# theme_classic()
corMatrix
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",colors = c("blue", "white", "red"))
# theme_classic()
corMatrix
theme_classic()
corMatrix
c
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient(low="red", high="yellow",) +
theme_classic()
corMatrix
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",colors = c("blue", "white", "red"))
corrplot(cor(seeds[1:7]), type = "upper", order = "hclust", tl.col = "black", tl.srt = 45,method = "circle")
seeds %>%
mixed_assoc() %>%
dplyr::select(x, y, assoc) %>%
spread(y, assoc) %>%
column_to_rownames("x") %>%
as.matrix %>%
as_cordf %>%
network_plot()
ggcorrplot(cor(seeds[1:7]),method = "circle",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",colors = c("blue", "white", "red"))
ggcorrplot(cor(seeds[1:7]),method = "square",hc.order = TRUE,outline.color = "white",lab=TRUE,insig = "blank",colors = c("blue", "white", "red"))
corMatrix = df_res %>%
ggplot(aes(x,y,fill=assoc))+
geom_tile()+
geom_text(aes(x,y,label=round(assoc,digits = 2)))+
scale_fill_gradient(low="red", high="yellow",) +
theme_classic()
corMatrix
seeds.pca <- prcomp(seeds[,1:7], center = TRUE, scale = TRUE)
summary(seeds.pca)
seeds.pca_df <- as.data.frame(seeds.pca$x[,c(1,2,3)]) #Dataset with only the first 3 principal components
seeds.pca_df$type <- seeds$type
summary(seeds.pca)
summary.PCA(seeds.pca)
##PCA (Pedro)----------------------------------------------------------------------------------
seeds.pca <- prcomp(seeds[,1:7], center = TRUE, scale = TRUE)
summary(seeds.pca)
summary(seeds.pca)
summary.PCA(seeds.pca)
summary.PCA(seeds.pca)
##PCA (Pedro)----------------------------------------------------------------------------------
seeds.pca <- prcomp(seeds[,1:7], center = TRUE, scale = TRUE)
seeds.pca
pairs(seeds,col=seeds[,8])
ggpairs(seeds, aes(colour = type, alpha = 0.4))
ggpairs?
?ggpairs?
help(ggpairs)
help(ggpairs)
ggpairs(seeds, aes(colour = type, alpha = 0.4),axisLabels = "internal")
ggpairs(seeds, aes(colour = type, alpha = 0.4),axisLabels = "show")
ggpairs(seeds, aes(colour = type, alpha = 0.4),axisLabels = "none")
>>>>>>> 794e3a83386aff673c6eeab73b6fa81e2214bf0a
